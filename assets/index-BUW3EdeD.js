import{d as z,r as h,j as e}from"./theme-provider-C3d4einS.js";import{c as B,B as c,P as T}from"./App-DM7DqXAy.js";import{i as L,b as f,I as S,e as A,t as p,a as D}from"./env-8iG8GCiW.js";import{U as F,L as g}from"./label-BenH-344.js";import{t as n}from"./index-rbqaS3as.js";import{T as U,a as H}from"./triangle-alert-Cy4xJOW4.js";import"./index-B5KUuKpD.js";/**
 * @license lucide-react v0.532.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],Q=B("pen-line",_),X=()=>{const j=z(),[r,N]=h.useState(!1),[i,l]=h.useState({name:"",icon:"default"}),[s,d]=h.useState(null),o=L({appId:A.instantDbAppId}),{data:m}=o.useQuery({categories:{}}),u=(m==null?void 0:m.categories.filter(a=>a.name!=="Default"))||[],k=a=>o.transact([p.categories[D()].create({...a})]),v=(a,t)=>o.transact([p.categories[a].update({...t})]),y=a=>o.transact([p.categories[a].delete()]),C=()=>{if(!i.name.trim()){n.error("Nama kategori wajib diisi");return}if(!i.icon){n.error("Pilih ikon kategori terlebih dahulu");return}k({name:i.name.trim(),icon:i.icon}),n.success("Kategori berhasil ditambahkan"),l({name:"",icon:"default"})},w=a=>{d(a),l({name:a.name,icon:a.icon})},I=()=>{if(s){if(!i.name.trim()){n.error("Nama kategori wajib diisi");return}if(!i.icon){n.error("Pilih ikon kategori terlebih dahulu");return}v(s.id,{name:i.name.trim(),icon:i.icon}),n.success("Kategori berhasil diperbarui"),d(null),l({name:"",icon:"default"})}},K=a=>{n.custom(t=>e.jsxs("div",{className:"bg-background w-full space-y-4 rounded-md border p-4 shadow-lg",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(H,{className:"h-4 w-4 text-amber-500"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm font-medium",children:"Hapus kategori ini?"}),e.jsx("span",{className:"text-muted-foreground text-xs",children:a.name})]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(c,{variant:"outline",size:"sm",onClick:()=>n.dismiss(t),children:"Batal"}),e.jsx(c,{variant:"destructive",size:"sm",onClick:()=>{y(a.id),n.dismiss(t),n.success("Kategori berhasil dihapus"),(s==null?void 0:s.id)===a.id&&(d(null),l({name:"",icon:"default"}))},children:"Hapus"})]})]}))},E=()=>{s?(d(null),l({name:"",icon:"default"})):j(-1)},P=()=>{N(!r),d(null),l({name:"",icon:"default"})};return e.jsxs("div",{className:"bg-background min-h-screen",children:[e.jsx("div",{className:"bg-background sticky top-0 z-40 border-b p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-2xl font-bold",children:r?"Kelola Kategori":"Tambah Kategori Baru"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(c,{size:"icon",variant:r?"default":"outline",onClick:P,children:[r?e.jsx(T,{}):e.jsx(Q,{}),e.jsx("span",{className:"sr-only",children:r?"Mode Tambah":"Mode Edit"})]}),e.jsxs(c,{size:"icon",onClick:()=>j(-1),children:[e.jsx(F,{}),e.jsx("span",{className:"sr-only",children:"Kembali"})]})]})]})}),e.jsxs("div",{className:"space-y-6 p-4",children:[r&&e.jsxs("div",{children:[e.jsxs(g,{className:"mb-3 block text-base font-medium",children:["Kategori yang Tersedia (",u.length,")"]}),u.length===0?e.jsxs("div",{className:"text-muted-foreground py-8 text-center",children:[e.jsx("p",{children:"Belum ada kategori yang tersedia"}),e.jsx("p",{className:"mt-1 text-sm",children:"Klik tombol + untuk beralih ke mode tambah kategori"})]}):e.jsx("div",{className:"max-h-[400px] space-y-2 overflow-y-auto",children:u.map(a=>{var b;const t=(b=f.find(x=>x.key===a.icon))==null?void 0:b.component,M=(s==null?void 0:s.id)===a.id;return e.jsxs("div",{className:`flex cursor-pointer items-center justify-between rounded-lg border p-3 transition-colors ${M?"border-primary bg-primary/5":"border-border hover:bg-muted/50"}`,onClick:()=>w(a),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[t&&e.jsx(t,{className:"h-5 w-5"}),e.jsx("span",{className:"font-medium",children:a.name})]}),e.jsx(c,{size:"sm",variant:"destructive",onClick:x=>{x.stopPropagation(),K(a)},children:e.jsx(U,{className:"h-4 w-4"})})]},a.id)})})]}),(!r||s)&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsxs(g,{htmlFor:"cat-name",className:"mb-2 block text-base font-medium",children:["Nama Kategori",e.jsx("span",{className:"ml-1 text-red-500",children:"*"})]}),e.jsx(S,{autoFocus:!0,id:"cat-name",value:i.name,onChange:a=>l({...i,name:a.target.value}),placeholder:"Masukkan nama kategori",className:"h-12 text-base"})]}),e.jsxs("div",{children:[e.jsx(g,{className:"mb-2 block text-base font-medium",children:"Pilih Icon"}),e.jsx("div",{className:"bg-muted/20 grid max-h-[300px] grid-cols-3 gap-3 overflow-y-auto rounded-lg border p-3",children:f.map(a=>{const t=a.component;return e.jsxs(c,{variant:i.icon===a.key?"default":"outline",onClick:()=>l({...i,icon:a.key}),className:"flex h-16 flex-col items-center justify-center gap-2 p-3",children:[e.jsx(t,{className:"h-5 w-5"}),e.jsx("span",{className:"truncate text-xs font-medium",children:a.name})]},a.key)})})]}),s&&e.jsx("div",{className:"bg-background rounded-lg border border-gray-500 p-3",children:e.jsxs("p",{className:"text-sm",children:[e.jsx("span",{className:"font-medium",children:"Sedang mengedit:"})," ",s.name]})})]})]}),(!r||s)&&e.jsxs("div",{className:"flex gap-3 p-4",children:[e.jsx(c,{variant:"outline",onClick:E,className:"h-12 flex-1",children:s?"Batal Edit":"Batal"}),e.jsx(c,{onClick:s?I:C,className:"h-12 flex-1",disabled:!i.name.trim()||!i.icon,children:s?"Perbarui":"Tambah"})]})]})};export{X as default};
