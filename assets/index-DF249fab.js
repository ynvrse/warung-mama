import{d as v,e as k,r as l,j as e}from"./theme-provider-C3d4einS.js";import{B as i,P as y}from"./App-DM7DqXAy.js";import{i as C,I as u,g as I,e as P,t as p,a as w}from"./env-8iG8GCiW.js";import{U as A,L as m}from"./label-BenH-344.js";import{t as n}from"./index-rbqaS3as.js";import{A as E}from"./AddCategoryModal-Bm4E53nh.js";import"./index-B5KUuKpD.js";import"./Combination-B9ghzp8d.js";const H=()=>{const d=v(),{productId:x}=k(),[h,g]=l.useState(!1),o=C({appId:P.instantDbAppId}),{data:r}=o.useQuery({products:{$:{where:{id:x}},categories:{}},categories:{}}),t=(r==null?void 0:r.products[0])||[],b=(r==null?void 0:r.categories)||[],[a,c]=l.useState(null);l.useEffect(()=>{t&&c({id:t.id,name:t.name,price:t.price,categoryId:t.categoryId})},[t]);const j=()=>{if(a){if(!a.name.trim()){n.error("Nama produk wajib diisi");return}if(!a.price||a.price<=0){n.error("Harga harus lebih dari 0");return}if(!a.categoryId){n.error("Pilih kategori terlebih dahulu");return}o.transact([p.products[a.id].update({...a,updatedAt:new Date})]),n.success("Produk berhasil diperbarui"),d("/")}},f=s=>o.transact([p.categories[w()].create({...s})]);return a?e.jsxs("div",{className:"bg-background min-h-screen",children:[e.jsx("div",{className:"bg-background sticky top-0 z-40 border-b p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Edit Produk"}),e.jsxs(i,{size:"icon",onClick:()=>d("/"),children:[e.jsx(A,{}),e.jsx("span",{className:"sr-only",children:"Kembali"})]})]})}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs(m,{htmlFor:"edit-name",className:"mb-2 block text-base font-medium",children:["Nama Produk",e.jsx("span",{className:"ml-1 text-red-500",children:"*"})]}),e.jsx(u,{id:"edit-name",value:a.name,onChange:s=>c({...a,name:s.target.value}),placeholder:"Masukkan nama produk",className:"h-12 text-base"})]}),e.jsxs("div",{children:[e.jsxs(m,{htmlFor:"edit-price",className:"mb-2 block text-base font-medium",children:["Harga",e.jsx("span",{className:"ml-1 text-red-500",children:"*"})]}),e.jsx(u,{id:"edit-price",type:"number",inputMode:"decimal",min:0,value:a.price===0?"":a.price,onChange:s=>c({...a,price:s.target.value===""?0:Number(s.target.value)}),placeholder:"Masukkan harga",className:"h-12 text-base",autoFocus:!0})]}),e.jsxs("div",{children:[e.jsxs(m,{className:"mb-2 block text-base font-medium",children:["Kategori",e.jsx("span",{className:"ml-1 text-red-500",children:"*"})]}),e.jsx("div",{className:"bg-muted/20 mt-2 grid grid-cols-3 gap-3 rounded-lg border p-3",children:b.map(s=>{const N=I(s.icon);return e.jsxs(i,{variant:a.categoryId===s.id?"default":"outline",onClick:()=>c({...a,categoryId:s.id}),className:"flex h-16 flex-col items-center justify-center gap-2 p-3",children:[e.jsx(N,{className:"h-5 w-5"}),e.jsx("span",{className:"truncate text-xs font-medium",children:s.name})]},s.id)})}),e.jsxs(i,{variant:"outline",onClick:()=>{d("/add-category")},className:"border-primary text-primary hover:bg-primary/5 mt-3 h-12 w-full border-dashed",children:[e.jsx(y,{className:"mr-2 h-4 w-4"}),"Tambah Kategori Baru"]})]})]}),e.jsxs("div",{className:"mt-8 flex gap-3",children:[e.jsx(i,{variant:"outline",onClick:()=>d("/"),className:"h-12 flex-1",children:"Batal"}),e.jsx(i,{onClick:j,className:"h-12 flex-1",children:"Simpan"})]})]}),e.jsx(E,{open:h,onClose:()=>g(!1),addCategory:f})]}):e.jsx("div",{className:"bg-background min-h-screen",children:e.jsx("div",{className:"p-10 text-center",children:e.jsx("div",{className:"text-muted-foreground",children:"Loading..."})})})};export{H as default};
